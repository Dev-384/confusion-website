<!DOCTYPE html>
<html>
	<head>
		<title>Confusion</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="icon" type="image/*" href="/assets/favicon.png">
		<link rel="stylesheet" href="/styles/index.css">
	</head>

	<body>
		<script type="module">

			import page from "./projects/pagebuilder.js";
	
			loadProject("confusion");
	
			async function loadProject(project){
				if(!project){
					document.body.innerHTML = "<iframe src='/404.html' style='position:fixed;top:0px;left:0px;width:100vw;height:100vh;border:none;outline:none;'></iframe>";
					return;
				}
	
				let projectName = project
					.split("_")
					.join(" ")
					.replace(/(^\w{1})|(\s+\w{1})/g, letter => letter.toUpperCase());
				
				let response = await fetch(`./projects/markdown/${project}.md`);
	
				let markdown = await response.text();
	
				let h1 = markdown.split(/^# {0,}(.*)/g)[1];
	
				page.new();
	
				page.setHeader({
					icon: "/assets/favicon.png",
					title: h1
				});
	
				let sections = markdown.replace(/^# {0,}(.*)/g, "");
				sections = sections.replace(/^(\s*)/g, "");
				sections = sections.split("## ");
	
				sections.forEach((content) => {
					content = content.replace(/^(\s*)/g, "");
					if(!content) return;
	
					let h2 = content.split(/^([\S ]*)/g)[1];
					h2 = h2.replace(/^(\s*)/g, "");
					let p = content.split(/^([\S ]*)/g)[2];
					p = p.replace(/^(\s*)/g, "");
					p = p.replace(/(\s*)$/g, "");
					p = p.replaceAll("\n", "<br>");
	
					page.addSection({
						title: h2,
						content: p
					});
				})
			}
		</script>
	</body>
</html>