<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Confusion | Github Authentication</title>
</head>
<body>
	<script type="module">
		import { Octokit } from "https://esm.sh/@octokit/core";

		var token = window.location.href.match(/code=([^&]*)/)[1];
		sessionStorage.setItem("github-code", token);

		let response = await fetch('https://api.github.com/user', {
			headers: {
				'Authorization': 'Bearer ${token}'
			}
		})
		let data = await response.json();
		console.log(data);


		const octokit = new Octokit({
			auth: token
		});

		var owner = "Dev-384";
		var repo = "confusion-website"
		var path = "projects/markdown/PROJECT.md";
		var content = "my new file contents";

		await octokit.request('PUT /repos/{owner}/{repo}/contents/{path}', {
			owner: owner,
			repo: repo,
			path: path,
			message: 'My commit message',
			committer: {
				name: 'Dev-384',
				email: 'elliott_3@loonielane.ca'
			},
			content: btoa(content),
			headers: {
				'X-GitHub-Api-Version': '2022-11-28'
			}
		});
	</script>
</body>
</html>